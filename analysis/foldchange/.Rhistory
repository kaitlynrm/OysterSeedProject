Head(tABACUSdata)
library(readr)
never_expressed_proteins <- read_csv("~/Desktop/protein_abundance/never_expressed_proteins.csv")
View(never_expressed_proteins)
test <- never_expressed_proteins[,c(2:27)]
View(test)
test <- never_expressed_proteins[,c(1, 27:100)]
View(test)
test <- never_expressed_proteins[,-2]
test <- never_expressed_proteins[,c(-2:-27)]
antitest <- never_expressed_proteins[,c(2:27)]
View(antitest)
View(never_expressed_proteins)
write_excel_csv(test, "c:/Desktop")
write_excel_csv(test, "C:\Users\Katty\Desktop\protein_abundance")
write.csv(test, "C:\Users/Katty/Desktop/protein_abundance/")
write.csv(test, "C:\Users/Katty/Desktop/protein_abundance/no_expression")
cd
pwd
getwd()
write.csv(test, "Desktop/protein_abundance/no_expression.csv")
write.csv(test, "Desktop/protein_abundance/no_expression.csv")
library(readr)
never_exressed_proteins <- read_csv("~/Desktop/protein_abundance/never_expressed_proteins.
q
wq
n
q
write.csv(test, "Desktop/protein_abundance/no_expression.cs
all_data <- read_xlsx("Documents/robertslab/labnotebook/raw_data/annotated_os.xlsx")
all_data <- read_csv("Desktop/protein_abundance/annotated_os.csv")
View(all_data)
all_data <- read_csv("Desktop/protein_abundance/annotated_os.csv")
test <- all_data([,c(1:7, seq(from = 8, to = 29, by = 3))])
test <- all_data(,c(1:7, seq(from = 8, to = 29, by = 3)))
test <- all_data[,c(1:7, seq(from = 8, to = 29, by = 3))]
View(test)
silo2 <- test
rm(test)
View(silo2)
View(all_data)
test <- all_data[,c(1:7, 30:100, seq(from = 8, to = 29, by = 3))]
View(test)
test <- all_data[,c(1:7, seq(from = 8, to = 29, by = 3), 30:100)]
16:23
test2 <- test(,c(,-15:-23))
test2 <- test[,c(,-15:-23)]
test2 <- test[,c(,-15:23)]
test2 <- test[,-(c(,-15:23))]
test2 <- test[,-15:23]
test2 <- test[, c(1:15,24:100)]
test2 <- test[, c(1:15,24:86)]
View(test2)
write.csv(test, "Desktop/protein_abundance/silo2_raw.csv")
View(silo2)
View(test)
test <- all_data[,c(1:7, seq(from = 8, to = 29, by = 2), 30:100)]
View(test)
test <- all_data[,c(1:7, seq(from = 10, to = 31, by = 2), 30:100)]
View(test)
test <- all_data[,c(1:7, seq(from = 10, to = 31, by = 3), 30:100)]
View(test)
silo9 <- test
view(test2)
View(test2)
silo2 <- test2
rm(test2)
rm(test)
View(silo9)
rm(silo9)
View(all_data)
test <- all_data[, c(1:7), seq(from = 8, to = 30, by = 3), 31:100]
test <- all_data[, c(1:7, seq(from = 8, to = 30, by = 3), 31:100)]
View(test)
test <- all_data[, c(1:7, seq(from = 9, to = 30, by = 3), 31:100)]
View(all_data)
test <- all_data[, c(1:7, seq(from = 8, to = 29, by = 3), 31:100)]
test <- all_data[, c(1:7, seq(from = 8, to = 29, by = 3), 31:100)]
test <- all_data[, c(1:7, seq(from = 9, to = 29, by = 3), 31:100)]
test <- all_data[, c(1:7, seq(from = 9, to = 30, by = 3), 30:100)]
View(test)
test <- all_data[, c(1:7, seq(from = 9, to = 28, by = 3), 29:100)]
silo3 <- test
test <- all_data[, c(1:7, seq(from = 10, to = 28, by = 3), 29:100)]
View(test)
silo9 <- test
View(silo9)
View(silo2)
View(silo3)
View(silo9)
write.csv()
write.csv(silo2, "Desktop/protein_abundance/silo2_proteins")
write.csv(silo3, "Desktop/protein_abundance/silo3_proteins")
write.csv(silo9, "Desktop/protein_abundance/silo9_proteins")
write.csv(silo2, "Desktop/protein_abundance/silo2_proteins.csv")
write.csv(silo9, "Desktop/protein_abundance/silo9_proteins.csv")
write.csv(silo3, "Desktop/protein_abundance/silo3_proteins.csv")
#Set WD
getwd()
setwd("C:/Users/Katty/Documents/robertslab/oysterseedproject/R_work/")
#Install and load packages
install.packages("vegan")
library(vegan)
install.packages("raster")
library(raster)
install.packages("BioStatR")
library(BioStatR)
source("biostats.R")
########Create NMDS plot with silo 3 and 9################
#upload file
ABACUSdata <- read.csv("~/Documents/robertslab/oysterseedproject/raw_os_data/ABACUSdata.csv", header=TRUE)
View(ABACUSdata)
#Remove NA
ABACUSdata[is.na(ABACUSdata)] <- 0
#Transpose- switch rows and columns
tABACUSdata <- t(ABACUSdata)
View(tABACUSdata)
#Rename Columns and remove row
colnames(tABACUSdata) <- tABACUSdata[1,]
tABACUSdata = tABACUSdata[-1,]
Head(tABACUSdata)
#Convert to numeric
is.numeric(tABACUSdata)
#Remove Silo 2
silo3and9 <- tABACUSdata[-(seq(from = 2, to = 22, by = 3)), ]
#Make MDS dissimilarity matrix
nmds.silo3and9 <- metaMDS(silo3and9, distance = 'euclidean', k = 2, trymax = 3000, autotransform = FALSE)
#upload file
ABACUSdata <- read.csv("~Documents\robertslab\labnotebook\raw_data\ABACUSdata.csv", header=TRUE)
View(ABACUSdata)
ABACUSdata <- read.csv("Documents\robertslab\labnotebook\raw_data\ABACUSdata.csv", header=TRUE)
library(readr)
ABACUSdata <- read_csv("~/Documents/robertslab/labnotebook/raw_data/ABACUSdata.csv")
View(ABACUSdata)
ABACUSdata <- read.csv("~/Documents/robertslab/labnotebook/raw_data/ABACUSdata.csv", header=TRUE)
View(ABACUSdata)
View(ABACUSdata)
#Remove NA
ABACUSdata[is.na(ABACUSdata)] <- 0
#Transpose- switch rows and columns
tABACUSdata <- t(ABACUSdata)
View(tABACUSdata)
#Rename Columns and remove row
colnames(tABACUSdata) <- tABACUSdata[1,]
tABACUSdata = tABACUSdata[-1,]
Head(tABACUSdata)
#Convert to numeric
is.numeric(tABACUSdata)
install.packages("installr");
library(installr)
updateR()
install.packages("installr");
install.packages("installr")
library(installr)
updateR()
#install packages for vegan and cluster
install.packages("vegan")
library(vegan)
install.packages("cluster")
library(cluster)
install.packages("cluster")
library(permute)
library(lattice)
library(vegan)
library(cluster)
allsilos <- read.csv('Documents/robertslab/labnotebook/raw_data/ABACUSdata.csv', header=T, row.names=1 )
install.packages("vegan")
install.packages("vegan")
library(permute)
library(lattice)
library(vegan)
install.packages("cluster")
install.packages("cluster")
library(cluster)
allsilos <- read.csv('Documents/robertslab/labnotebook/raw_data/ABACUSdata.csv', header=T, row.names=1 )
silo2 <- allsilos[, (seq(from = 2, to = 22, by = 3))]
silo3 <- allsilos[, (seq(from = 3, to = 22, by = 3))]
silo9 <- allsilos[, (seq(from = 4, to = 22, by = 3))]
silo2.eucd <- vegdist(silo2, method='euclidean')
install.packages("vegan")
library(vegan)
install.packages("vegan")
library(permute)
library(lattice)
library(vegan)
library(raster)
library(sp)
library(raster)
library(sp)
library(BioStatR)
source("biostats.R")
ABACUSdata <- read.csv("~/Documents/robertslab/labnotebook/raw_data/ABACUSdata.csv", header=TRUE)
tABACUSdata <- t(ABACUSdata)
is.numeric(ABACUSdata)
as.numeric(ABACUSdata)
colnames(tABACUSdata) <- tABACUSdata[1,]
tABACUSdata <- tABACUSdata[-1,]
tABACUSdata[is.na(tABACUSdata)] <- 0
is.numeric(tABACUSdata)
as.numeric(tABACUSdata)
is.numeric(tABACUSdata)
tABACUSdata2 <- as.numeric(tABACUSdata)
is.numeric(tABACUSdata2)
write.csv("Documents/robertslab/tABACUS2.csv")
write.csv("Documents/robertslab/", tABACUSdata.csv)
?write.csv
write.csv(tABACUSdata, "Documents/robertslab/tABACUSdata.csv")
?clusplot()
allsilos <- read.csv('Documents/robertslab/labnotebook/raw_data/ABACUSdata.csv', header=T, row.names=1 )
silo2 <- allsilos[, (seq(from = 2, to = 22, by = 3))]
silo3 <- allsilos[, (seq(from = 3, to = 22, by = 3))]
silo9 <- allsilos[, (seq(from = 4, to = 22, by = 3))]
silo2.eucd <- vegdist(silo2, method='euclidean')
pca_silo2 <- princomp(silo2)
summary(pca_silo2)
screeplot(pca_silo2)
silo2.2clus <- kmeans(silo2.eucd, centers=2, iter.max=10000, nstart=25)
View(tABACUSdata)
library("matrixStats", "Hmisc", "splines", "foreach", "doParallel", "fastcluster", "dynamicTreeCut", "survival")
install.packages(c("matrixStats", "Hmisc", "splines", "foreach", "doParallel", "fastcluster", "dynamicTreeCut", "survival")
source("http://bioconductor.org/biocLite.R")
biocLite(c("GO.db", "preprocessCore", "impute"))
library("matrixStats", "Hmisc", "splines", "foreach", "doParallel", "fastcluster", "dynamicTreeCut", "survival")
#Packages for annotations
orgCodes = c("Hs", "Mm", "Rn", "Pf", "Sc", "Dm", "Bt", "Ce", "Cf", "Dr", "Gg");
orgExtensions = c(rep(".eg", 4), ".sgd", rep(".eg", 6));
packageNames = paste("org.", orgCodes, orgExtensions, ".db", sep="");
biocLite(c("GO.db", "KEGG.db", "topGO", packageNames, "hgu133a.db", "hgu95av2.db", "annotate", "hgu133plus2.db", "SNPlocs.Hsapiens.dbSNP.20100427", "minet", "OrderedList"))
#WGCNA package
install.packages("path/to/file", repos = NULL, lib=.Library)
install.packages(c("matrixStats", "Hmisc", "splines", "foreach", "doParallel", "fastcluster", "dynamicTreeCut", "survival")
source("http://bioconductor.org/biocLite.R")
biocLite(c("GO.db", "preprocessCore", "impute"))
library("matrixStats", "Hmisc", "splines", "foreach", "doParallel", "fastcluster", "dynamicTreeCut", "survival")
#Packages for annotations
orgCodes = c("Hs", "Mm", "Rn", "Pf", "Sc", "Dm", "Bt", "Ce", "Cf", "Dr", "Gg");
orgExtensions = c(rep(".eg", 4), ".sgd", rep(".eg", 6));
packageNames = paste("org.", orgCodes, orgExtensions, ".db", sep="");
biocLite(c("GO.db", "KEGG.db", "topGO", packageNames, "hgu133a.db", "hgu95av2.db", "annotate", "hgu133plus2.db", "SNPlocs.Hsapiens.dbSNP.20100427", "minet", "OrderedList"))
#WGCNA package
install.packages("path/to/file", repos = NULL, lib=.Library)
install.packages("matrixStats", "Hmisc", "splines", "foreach", "doParallel", "fastcluster", "dynamicTreeCut", "survival")
install.packages("matrixStats") , "Hmisc", "splines", "foreach", "doParallel", "fastcluster", "dynamicTreeCut", "survival")
install.packages("matrixStats")
install.packages( , "Hmisc", "splines", "foreach", "doParallel", "fastcluster", "dynamicTreeCut", "survival")
install.packages("Hmisc", "splines", "foreach", "doParallel", "fastcluster", "dynamicTreeCut", "survival")
install.packages("Hmisc")
install.packages("splines")
install.packages("foreach")
install.packages("doParallel")
install.packages("fastcluster")
install.packages("dynamicTreeCut")
install.packaches("survival")
source("http://bioconductor.org/biocLite.R")
biocLite(c("GO.db", "preprocessCore", "impute"))
library("matrixStats", "Hmisc", "splines", "foreach", "doParallel", "fastcluster", "dynamicTreeCut", "survival")
library(matrixStats, Hmisc, splines, foreach, doParallel, fastcluster, dynamicTreeCut, survival)
library(matrixStats) library(Hmisc) library(splines) library(foreach) library(doParallel) library(fastcluster) library(dynamicTreeCut) library(survival)
library(matrixStats), library(Hmisc) library(splines) library(foreach) library(doParallel) library(fastcluster) library(dynamicTreeCut) library(survival)
library(matrixStats)
library(Hmisc)
library(lattice)
library(survival)
library(permute)
library(Formula)
library(ggplot2)
library(matrixStats)
library(Hmisc)
library(splines)
library(foreach)
library(doParallel)
library(fastcluster)
library(iterators)
library(parallel)
library(doParallel)
library(fastcluster)
library(dynamicTreeCut)
library(survival)
orgCodes = c("Hs", "Mm", "Rn", "Pf", "Sc", "Dm", "Bt", "Ce", "Cf", "Dr", "Gg");
orgExtensions = c(rep(".eg", 4), ".sgd", rep(".eg", 6));
packageNames = paste("org.", orgCodes, orgExtensions, ".db", sep="");
orgCodes = c("Hs", "Mm", "Rn", "Pf", "Sc", "Dm", "Bt", "Ce", "Cf", "Dr", "Gg");
orgExtensions = c(rep(".eg", 4), ".sgd", rep(".eg", 6));
packageNames = paste("org.", orgCodes, orgExtensions, ".db", sep="");
biocLite(c("GO.db", "KEGG.db", "topGO", packageNames, "hgu133a.db", "hgu95av2.db", "annotate", "hgu133plus2.db", "SNPlocs.Hsapiens.dbSNP.20100427", "minet", "OrderedList"))
source("http://bioconductor.org/biocLite.R")
biocLite(c("AnnotationDbi", "impute", "GO.db", "preprocessCore"))
install.packages("WGCNA")
library(permute)
library(lattice)
library(vegan)
library(cluster)
allsilos <- read.csv('Documents/robertslab/labnotebook/raw_data/ABACUSdata.csv', header=T, row.names=1 )
silo2 <- allsilos[, (seq(from = 2, to = 22, by = 3))]
silo3 <- allsilos[, (seq(from = 3, to = 22, by = 3))]
silo9 <- allsilos[, (seq(from = 4, to = 22, by = 3))]
silo2.eucd <- vegdist(silo2, method='euclidean')
pca_silo2 <- princomp(silo2)
summary(pca_silo2)
screeplot(pca_silo2)
silo2.2clus <- kmeans(silo2.eucd, centers=4, iter.max=10000, nstart=25)
silo2.2clus <- kmeans(silo2.eucd, centers=3, iter.max=10000, nstart=25)
silo2.3clus <- kmeans(silo2.eucd, centers=3, iter.max=10000, nstart=25)
save.image("~/Documents/robertslab/r.RData")
?kmeans
?options
?max.print
silo2.3clus
show
library(vegan, cluster, pvclust, fpc)
sessionInfo()
allsilos <- read.csv('Documents/robertslab/labnotebook/raw_data/ABACUSdata.csv', header=T, row.names=1 )
silo2 <- allsilos[, (seq(from = 2, to = 22, by = 3))]
silo3 <- allsilos[, (seq(from = 3, to = 22, by = 3))]
allsilos <- read.csv('Documents/robertslab/labnotebook/raw_data/ABACUSdata.csv', header=T, row.names=1 )
silo2 <- allsilos[, (seq(from = 2, to = 22, by = 3))]
silo3 <- allsilos[, (seq(from = 3, to = 22, by = 3))]
silo9 <- allsilos[, (seq(from = 4, to = 22, by = 3))]
View(silo2)
?rowMeans
silo2$mean <- rowMeans(silo2)
View(silo2)
silo2$stdev <- rowSds(silo2)
install.packages("matrixStats")
library(matrixStats)
silo2$stdev <- rowSds(silo2)
?apply
silo2.matrix <-  data.matrix(silo2, rownames.force = NULL)
silo2.matrix <-  data.matrix(silo2)
silo2$stdev <- rowSds(silo2)
silo2.matrix$stdev <- rowSds(silo2)
silo2$stdev <- rowSds(silo2.matrix) #standard deviation
install.packages("matrixStats")
library(matrixStats)
allsilos <- read.csv('Documents/robertslab/labnotebook/raw_data/ABACUSdata.csv', header=T, row.names=1 )
silo2 <- allsilos[, (seq(from = 2, to = 22, by = 3))]
silo3 <- allsilos[, (seq(from = 3, to = 22, by = 3))]
silo9 <- allsilos[, (seq(from = 4, to = 22, by = 3))]
silo2$mean <- rowMeans(silo2) #mean
silo2.matrix <-  data.matrix(silo2)
silo2$stdev <- rowSds(silo2.matrix) #standard deviation
silo2$variance <- rowVars(silo2.matrix) #variance
silo2$total-abundance <- rowSums(silo2) #sum
?row
silo2$Total.Abundance <- rowSums(silo2) #sum
silo2$median <- rowMedians(silo2)
silo2$median <- rowMedians(silo2.matrix)
pwd
getwd()
read.csv("Documents/robertslab/labnotebook/data/allsilos-tag_and_annot.csv")
getwd()
asca <- read.csv("Downloads/uniprot_PC1_0.04.csv")
clus <- read.csv("Documents/robertslab/labnotebook/analysis/clustering/silo3_9/all-proteins/no0-unique-clus-prot-silo3_9.csv")
colnames(asca)[1] <- "Protein"
colnames(clus)[1] <- "Protein"
same <- merge(asca, clus, by = "Protein")
View(clus)
View(asca)
which(asca, "CHOYP_AAEL_AAEL008069.2.2m.60920")
?which
?grepl
grepl(clus, clus$Protein)
any(grepl(clus, clus$Protein))
any(grepl(clus, clus))
any(grepl(clus, asca))
grepl(clus, asca)
grepl(CHOYP_AAEL_AAEL008069.2.2m.60920, asca)
grepl(asca$Protein, CHOYP_AAEL_AAEL008069.2.2m.60920)
grepl("CHOYP_AAEL_AAEL008069.2.2m.60920", asca$Protein)
any(grepl("CHOYP_AAEL_AAEL008069.2.2m.60920", asca$Protein))
any(grepl("CHOYP_AAEL_AAEL008069.2.2m.60920", clus$Protein))
library(stringr)
clus %>% mutate(text = str_replace_all(text, '\\|', ""))
?mutate
library(dplyr)
clus %>% mutate(str_replace_all(text, '\\|', ""))
clus %>% mutate(text = str_replace_all(text, '\\|', ""))
clus %>% str_replace_all(text, '\\|', "")
grepl("|", clus$Protein)
clus$Protein <- str_replace_all(clus$Protein, '|', '')
any(grepl("|", clus$Protein))
View(clus)
class(clus$Protein)
asca <- read.csv("Downloads/uniprot_PC1_0.04.csv")
chartr("|", "", clus$Protein)
gsub("|", "", clus$Protein)
clus$Protein <- gsub("|", "", clus$Protein)
any(grepl("|", clus$Protein))
clus[,1:3]
View(clus)
#data
allsilos <- read.csv("Documents/robertslab/labnotebook/data/allsilos-tag_and_annot.csv")
silo3.9 <- allsilos[,-c(3,6,9,12,15,18,21)]
#logtransform
silo3.9 <- cbind(silo3.9[,c(1,43,59)],log(silo3.9[,3:16], 2))
colnames(silo3.9)[2] <- "Uniprot"
#foldchanges
silo3.9$fc3 <- foldchange(silo3.9$X9_3,silo3.9$X3_3)
silo3.9$fc5 <- foldchange(silo3.9$X9_5,silo3.9$X3_5)
silo3.9$fc7 <- foldchange(silo3.9$X9_7,silo3.9$X3_7)
silo3.9$fc9 <- foldchange(silo3.9$X9_9,silo3.9$X3_9)
silo3.9$fc11 <- foldchange(silo3.9$X9_11,silo3.9$X3_11)
silo3.9$fc13 <- foldchange(silo3.9$X9_13,silo3.9$X3_13)
silo3.9$fc15 <- foldchange(silo3.9$X9_15,silo3.9$X3_15)
fc <- silo3.9[,c(1:3,18:24)]
#make seperate dataframes
day3 <- fc[,c(1:3,4)]
day5 <- fc[,c(1:3,5)]
day7 <- fc[,c(1:3,6)]
day9 <- fc[,c(1:3,7)]
day11 <- fc[,c(1:3,8)]
day13 <- fc[,c(1:3,9)]
day15 <- fc[,c(1:3,10)]
#remove NaN and Inf, and set cutoff fold change
day3 <-  day3[which(!is.na(day3$fc3) & !is.infinite(day3$fc3) & day3$fc3 >= 2 | !is.na(day3$fc3) & !is.infinite(day3$fc3) & day3$fc3 <= -2),]
day5 <-  day5[which(!is.na(day5$fc5) & !is.infinite(day5$fc5) & day5$fc5 >= 2 | !is.na(day5$fc5) & !is.infinite(day5$fc5) & day5$fc5 <= -2),]
day7 <-  day7[which(!is.na(day7$fc7) & !is.infinite(day7$fc7) & day7$fc7 >= 2 | !is.na(day7$fc7) & !is.infinite(day7$fc7) & day7$fc7 <= -2),]
day9 <-  day9[which(!is.na(day9$fc9) & !is.infinite(day9$fc9) & day9$fc9 >= 2 | !is.na(day9$fc9) & !is.infinite(day9$fc9) & day9$fc9 <= -2),]
day11 <-  day11[which(!is.na(day11$fc11) & !is.infinite(day11$fc11) & day11$fc11 >= 2 | !is.na(day11$fc11) & !is.infinite(day11$fc11) & day11$fc11 <= -2),]
day13 <-  day13[which(!is.na(day13$fc13) & !is.infinite(day13$fc13) & day13$fc13 >= 2 | !is.na(day13$fc13) & !is.infinite(day13$fc13) & day13$fc13 <= -2),]
day15 <-  day15[which(!is.na(day15$fc15) & !is.infinite(day15$fc15) & day15$fc15 >= 2 | !is.na(day15$fc15) & !is.infinite(day15$fc15) & day15$fc15 <= -2),]
#save dataframes
setwd("Documents/robertslab/labnotebook/analysis/fold_change/")
write.csv(day3, "fc3.csv")
write.csv(day5, "fc5.csv")
write.csv(day7, "fc7.csv")
write.csv(day9, "fc9.csv")
write.csv(day11, "fc11.csv")
write.csv(day13, "fc13.csv")
write.csv(day15, "fc15.csv")
silo3.9 <- allsilos[,-c(3,6,9,12,15,18,21)]
#logtransform
silo3.9 <- cbind(silo3.9[,c(1,43,59)],log(silo3.9[,3:16], 2))
colnames(silo3.9)[2] <- "Uniprot"
#foldchanges
silo3.9$fc3 <- foldchange(silo3.9$X9_3,silo3.9$X3_3)
silo3.9$fc5 <- foldchange(silo3.9$X9_5,silo3.9$X3_5)
silo3.9$fc7 <- foldchange(silo3.9$X9_7,silo3.9$X3_7)
silo3.9$fc9 <- foldchange(silo3.9$X9_9,silo3.9$X3_9)
silo3.9$fc11 <- foldchange(silo3.9$X9_11,silo3.9$X3_11)
silo3.9$fc13 <- foldchange(silo3.9$X9_13,silo3.9$X3_13)
silo3.9$fc15 <- foldchange(silo3.9$X9_15,silo3.9$X3_15)
fc <- silo3.9[,c(1:3,18:24)]
#make seperate dataframes
day3 <- fc[,c(1:3,4)]
day5 <- fc[,c(1:3,5)]
day7 <- fc[,c(1:3,6)]
day9 <- fc[,c(1:3,7)]
day11 <- fc[,c(1:3,8)]
day13 <- fc[,c(1:3,9)]
day15 <- fc[,c(1:3,10)]
#remove NaN and Inf, and set cutoff fold change
day3 <-  day3[which(!is.na(day3$fc3) & !is.infinite(day3$fc3) & day3$fc3 >= 2 | !is.na(day3$fc3) & !is.infinite(day3$fc3) & day3$fc3 <= -2),]
day5 <-  day5[which(!is.na(day5$fc5) & !is.infinite(day5$fc5) & day5$fc5 >= 2 | !is.na(day5$fc5) & !is.infinite(day5$fc5) & day5$fc5 <= -2),]
day7 <-  day7[which(!is.na(day7$fc7) & !is.infinite(day7$fc7) & day7$fc7 >= 2 | !is.na(day7$fc7) & !is.infinite(day7$fc7) & day7$fc7 <= -2),]
day9 <-  day9[which(!is.na(day9$fc9) & !is.infinite(day9$fc9) & day9$fc9 >= 2 | !is.na(day9$fc9) & !is.infinite(day9$fc9) & day9$fc9 <= -2),]
day11 <-  day11[which(!is.na(day11$fc11) & !is.infinite(day11$fc11) & day11$fc11 >= 2 | !is.na(day11$fc11) & !is.infinite(day11$fc11) & day11$fc11 <= -2),]
day13 <-  day13[which(!is.na(day13$fc13) & !is.infinite(day13$fc13) & day13$fc13 >= 2 | !is.na(day13$fc13) & !is.infinite(day13$fc13) & day13$fc13 <= -2),]
day15 <-  day15[which(!is.na(day15$fc15) & !is.infinite(day15$fc15) & day15$fc15 >= 2 | !is.na(day15$fc15) & !is.infinite(day15$fc15) & day15$fc15 <= -2),]
setwd("../../../../")
setwd("../")
allsilos <- read.csv("Documents/robertslab/labnotebook/data/allsilos-tag_and_annot.csv")
silo3.9 <- allsilos[,-c(3,6,9,12,15,18,21)]
silo3.9 <- cbind(silo3.9[,c(1,43,59)],log(silo3.9[,3:16], 2))
colnames(silo3.9)[2] <- "Uniprot"
silo3.9$fc3 <- foldchange(silo3.9$X9_3,silo3.9$X3_3)
silo3.9$fc5 <- foldchange(silo3.9$X9_5,silo3.9$X3_5)
library(gtools)
silo3.9$fc3 <- foldchange(silo3.9$X9_3,silo3.9$X3_3)
silo3.9$fc5 <- foldchange(silo3.9$X9_5,silo3.9$X3_5)
silo3.9$fc7 <- foldchange(silo3.9$X9_7,silo3.9$X3_7)
silo3.9$fc9 <- foldchange(silo3.9$X9_9,silo3.9$X3_9)
silo3.9$fc11 <- foldchange(silo3.9$X9_11,silo3.9$X3_11)
silo3.9$fc13 <- foldchange(silo3.9$X9_13,silo3.9$X3_13)
silo3.9$fc15 <- foldchange(silo3.9$X9_15,silo3.9$X3_15)
fc <- silo3.9[,c(1:3,18:24)]
day3 <- fc[,c(1:3,4)]
day5 <- fc[,c(1:3,5)]
day7 <- fc[,c(1:3,6)]
day9 <- fc[,c(1:3,7)]
day11 <- fc[,c(1:3,8)]
day13 <- fc[,c(1:3,9)]
day15 <- fc[,c(1:3,10)]
day3 <-  day3[which(!is.na(day3$fc3) & !is.infinite(day3$fc3) & day3$fc3 >= 2 | !is.na(day3$fc3) & !is.infinite(day3$fc3) & day3$fc3 <= -2),]
day5 <-  day5[which(!is.na(day5$fc5) & !is.infinite(day5$fc5) & day5$fc5 >= 2 | !is.na(day5$fc5) & !is.infinite(day5$fc5) & day5$fc5 <= -2),]
day7 <-  day7[which(!is.na(day7$fc7) & !is.infinite(day7$fc7) & day7$fc7 >= 2 | !is.na(day7$fc7) & !is.infinite(day7$fc7) & day7$fc7 <= -2),]
day9 <-  day9[which(!is.na(day9$fc9) & !is.infinite(day9$fc9) & day9$fc9 >= 2 | !is.na(day9$fc9) & !is.infinite(day9$fc9) & day9$fc9 <= -2),]
day11 <-  day11[which(!is.na(day11$fc11) & !is.infinite(day11$fc11) & day11$fc11 >= 2 | !is.na(day11$fc11) & !is.infinite(day11$fc11) & day11$fc11 <= -2),]
day13 <-  day13[which(!is.na(day13$fc13) & !is.infinite(day13$fc13) & day13$fc13 >= 2 | !is.na(day13$fc13) & !is.infinite(day13$fc13) & day13$fc13 <= -2),]
day15 <-  day15[which(!is.na(day15$fc15) & !is.infinite(day15$fc15) & day15$fc15 >= 2 | !is.na(day15$fc15) & !is.infinite(day15$fc15) & day15$fc15 <= -2),]
setwd("Documents/robertslab/labnotebook/analysis/fold_change/")
View(day3)
write.csv(day3, "fc3.csv")
write.csv(day5, "fc5.csv")
write.csv(day7, "fc7.csv")
write.csv(day9, "fc9.csv")
write.csv(day11, "fc11.csv")
write.csv(day13, "fc13.csv")
write.csv(day15, "fc15.csv")
